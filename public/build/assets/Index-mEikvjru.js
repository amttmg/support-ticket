import{_ as I}from"./AuthenticatedLayout-BeAxI95q.js";import{i as O,f as i,o as n,a as h,u as k,g as P,w as y,b as t,h as a,F as _,k as L,n as c,t as l,e as d,S as D,Q as w}from"./app-BSgs8Lu9.js";import{_ as U}from"./TicketTabs-D8NEmtoy.js";import{S as u}from"./sweetalert-B6YkYn-g.js";const J={class:"flex items-center justify-between"},K={class:"py-8"},W={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},X={class:"overflow-hidden bg-white shadow-xl sm:rounded-xl"},Y={class:"p-6 sm:p-8"},Z={class:"grid grid-cols-1 gap-4 mb-8 md:grid-cols-5"},tt=["onClick"],et={class:"mt-1 text-2xl font-bold text-indigo-800"},ot={key:0,class:"flex items-center mb-4"},st={class:"text-sm text-gray-600"},rt={class:"font-semibold"},it={class:"overflow-hidden bg-white border border-gray-100 rounded-xl"},nt={class:"overflow-x-auto"},lt={class:"min-w-full divide-y divide-gray-200"},dt={class:"bg-gray-50"},at={key:0},ct={key:1},ut={key:0},pt={key:1},gt={key:0},xt={key:1},mt={class:"bg-white divide-y divide-gray-100"},ft={class:"px-6 py-4"},ht={class:"flex items-center"},wt={class:"ml-4"},yt={class:"text-sm font-semibold text-gray-900"},vt={class:"text-xs text-gray-500"},bt={class:"px-6 py-4 whitespace-nowrap"},kt={class:"inline-flex px-3 py-1 text-xs font-semibold leading-5 capitalize rounded-full"},_t={class:"px-6 py-4 whitespace-nowrap"},Ct={class:"py-4 px-6- whitespace-nowrap"},St={class:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap"},Tt={class:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap"},Mt={class:"px-4 py-3 text-sm text-right whitespace-nowrap"},$t={class:"flex flex-col items-end space-y-2"},jt={key:0,class:"flex space-x-2"},Bt=["onClick"],Nt=["onClick"],zt={key:0},Dt={__name:"Index",props:{tickets:{type:Array,default:()=>[]},statuses:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},total_tickets:{type:Number,default:0},has_bm_role:{type:Boolean,default:!1}},setup(r){const p=r,v=s=>{const e=p.filters.sort===s?`-${s}`:s;w.get(route("tickets.index"),{...p.filters,sort:e},{preserveState:!0,replace:!0})},R=async s=>{(await u.confirm({title:"Re-open Ticket?",text:"This will change the ticket status back to open",icon:"question",confirmColor:"#10B981",confirmText:"Re-open"})).isConfirmed&&w.put(route("tickets.reopen",s.id),{onSuccess:()=>{u.success("Ticket has been re-opened!")},onError:()=>{u.error("Failed to re-open ticket")}})},E=async s=>{(await u.confirm({title:"Close Ticket?",text:"This will permanently close the ticket",icon:"warning",confirmColor:"#EF4444",confirmText:"Close"})).isConfirmed&&w.put(route("tickets.close",s.id),{onSuccess:()=>{u.success("Ticket has been closed!")},onError:()=>{u.error("Failed to close ticket")}})},H={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800",urgent:"bg-purple-100 text-purple-800"},Q=s=>{const e=(s==null?void 0:s.color)||"gray";return{gray:"bg-gray-100 text-gray-800",blue:"bg-blue-100 text-blue-800",yellow:"bg-yellow-100 text-yellow-800",green:"bg-green-100 text-green-800",red:"bg-red-100 text-red-800",purple:"bg-purple-100 text-purple-800",indigo:"bg-indigo-100 text-indigo-800"}[e]||"bg-gray-100 text-gray-800"},C=s=>{w.get(route("tickets.index"),{status:s},{preserveState:!0,replace:!0})},q=()=>{w.get(route("tickets.index"),{},{preserveState:!0,replace:!0})},S=O(()=>{var e;if(!((e=p.filters)!=null&&e.status))return null;const s=p.statuses.find(x=>x.id==p.filters.status);return(s==null?void 0:s.name)||null}),g=s=>{const e=(s==null?void 0:s.color)||"gray";return{border:`border-${e}-200`,bg:`bg-${e}-50`,text:`text-${e}-600`,hover:`hover:border-${e}-400`}};return(s,e)=>(n(),i(_,null,[h(k(P),{title:"My Tickets"}),h(I,null,{header:y(()=>[t("div",J,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," My Support Tickets ",-1)),h(k(D),{href:s.route("tickets.create"),class:"inline-flex items-center px-4 py-2 text-sm font-semibold tracking-widest text-white uppercase transition-all duration-150 ease-in-out border border-transparent rounded-lg shadow-md bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-700 hover:to-indigo-600 active:from-indigo-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 hover:shadow-lg"},{default:y(()=>e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"})],-1),d(" New Ticket ")])),_:1,__:[4]},8,["href"])])]),default:y(()=>{var x,T,M,$,j,B,N,z;return[t("div",K,[t("div",W,[h(U,{active:"my-tickets",has_bm_role:r.has_bm_role},null,8,["has_bm_role"]),t("div",X,[t("div",Y,[t("div",Z,[(n(!0),i(_,null,L(r.statuses,o=>{var m,f;return n(),i("div",{key:o.id,onClick:b=>C(o.id),class:c(["p-4 transition-all duration-200 border-2 rounded-lg cursor-pointer",[g(o).border,g(o).bg,{"border-indigo-500 ring-1 ring-indigo-200":((m=r.filters)==null?void 0:m.status)==o.id||!((f=r.filters)!=null&&f.status)&&o.name.toLowerCase()==="open"},g(o).hover]])},[t("div",{class:c(["text-sm font-medium",g(o).text])},l(o.name),3),t("div",{class:c(["mt-1 text-2xl font-bold",g(o).text])},l(o.tickets_count||0),3)],10,tt)}),128)),t("div",{onClick:e[0]||(e[0]=o=>C("all")),class:c(["p-4 transition-all duration-200 border-2 rounded-lg cursor-pointer hover:border-indigo-300",["border-indigo-100 bg-indigo-50",{"border-indigo-500 ring-1 ring-indigo-200":((x=r.filters)==null?void 0:x.status)=="all"}]])},[e[6]||(e[6]=t("div",{class:"text-sm font-medium text-indigo-600"},"Total Tickets",-1)),t("div",et,l(r.total_tickets),1)],2)]),(T=r.filters)!=null&&T.status&&S.value?(n(),i("div",ot,[t("span",st,[e[7]||(e[7]=d(" Showing tickets with status: ")),t("span",rt,l(S.value),1)]),t("button",{onClick:q,class:"ml-2 text-sm text-indigo-600 hover:text-indigo-800"}," (Clear filter) ")])):a("",!0),t("div",it,[t("div",nt,[t("table",lt,[t("thead",dt,[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase cursor-pointer select-none hover:text-indigo-700",onClick:e[1]||(e[1]=o=>v("title"))},[e[8]||(e[8]=d(" Ticket Details ")),((M=r.filters)==null?void 0:M.sort)==="title"?(n(),i("span",at,"▲")):(($=r.filters)==null?void 0:$.sort)==="-title"?(n(),i("span",ct,"▼")):a("",!0)]),e[11]||(e[11]=t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase cursor-pointer select-none hover:text-indigo-700"}," Department ",-1)),t("th",{scope:"col",onClick:e[2]||(e[2]=o=>v("priority")),class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"},[e[9]||(e[9]=d(" Priority ")),((j=r.filters)==null?void 0:j.sort)==="priority"?(n(),i("span",ut,"▲")):((B=r.filters)==null?void 0:B.sort)==="-priority"?(n(),i("span",pt,"▼")):a("",!0)]),e[12]||(e[12]=t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Status ",-1)),t("th",{scope:"col",onClick:e[3]||(e[3]=o=>v("updated_at")),class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"},[e[10]||(e[10]=d(" Last Updated ")),((N=r.filters)==null?void 0:N.sort)==="updated_at"?(n(),i("span",gt,"▲")):((z=r.filters)==null?void 0:z.sort)==="-updated_at"?(n(),i("span",xt,"▼")):a("",!0)]),e[13]||(e[13]=t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Creator ",-1)),e[14]||(e[14]=t("th",{scope:"col",class:"relative px-6 py-3"},[t("span",{class:"sr-only"},"Actions")],-1))])]),t("tbody",mt,[(n(!0),i(_,null,L(r.tickets,o=>{var m,f,b,V,A,F;return n(),i("tr",{key:o.id,class:"transition-colors duration-150 hover:bg-gray-50"},[t("td",ft,[t("div",ht,[e[15]||(e[15]=t("div",{class:"flex items-center justify-center flex-shrink-0 w-10 h-10 text-indigo-700 rounded-lg bg-indigo-50"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("div",wt,[t("div",yt,l(o.title),1),t("div",vt," #"+l(o.id)+" • "+l(new Date(o.created_at).toLocaleDateString()),1)])])]),t("td",bt,[t("span",kt,[d(l(((b=(f=(m=o.support_topic)==null?void 0:m.support_unit)==null?void 0:f.department)==null?void 0:b.name)||"N/A")+" ",1),e[16]||(e[16]=t("br",null,null,-1)),d(" "+l(((A=(V=o.support_topic)==null?void 0:V.support_unit)==null?void 0:A.name)||"N/A")+" ",1),e[17]||(e[17]=t("br",null,null,-1)),d(" "+l(((F=o.support_topic)==null?void 0:F.name)||"N/A"),1)])]),t("td",_t,[t("span",{class:c([H[o.priority]||"bg-gray-100 text-gray-800","inline-flex px-3 py-1 text-xs font-semibold leading-5 capitalize rounded-full"])},l(o.priority),3)]),t("td",Ct,[t("span",{class:c([Q(o.status),"inline-flex px-3 py-1 text-xs font-semibold leading-5 capitalize rounded-full"])},l(o.status.name),3)]),t("td",St,l(o.formatted_updated_at),1),t("td",Tt,l(o.creator.name),1),t("td",Mt,[t("div",$t,[h(k(D),{href:s.route("tickets.show",o.id),class:"inline-flex items-center px-3 py-1.5 text-xs font-semibold text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg shadow transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-indigo-400 mr-2"},{default:y(()=>e[18]||(e[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),d(" View ")])),_:2,__:[18]},1032,["href"]),o.status.name.toLowerCase()==="resolved"?(n(),i("div",jt,[t("button",{onClick:G=>R(o),class:"inline-flex items-center px-3 py-1.5 text-xs font-semibold text-white bg-green-600 hover:bg-green-700 rounded-lg shadow transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-green-400",title:"Re-open Ticket"},e[19]||(e[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2a4 4 0 014-4h3"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h3v3"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17a5 5 0 10-5-5"})],-1),d(" Re-open ")]),8,Bt),t("button",{onClick:G=>E(o),class:"inline-flex items-center px-3 py-1.5 text-xs font-semibold text-white bg-red-600 hover:bg-red-700 rounded-lg shadow transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-red-400",title:"Close Ticket"},e[20]||(e[20]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),d(" Close ")]),8,Nt)])):a("",!0)])])])}),128)),r.tickets.length===0?(n(),i("tr",zt,e[21]||(e[21]=[t("td",{colspan:"6",class:"px-6 py-12 text-center"},[t("div",{class:"flex flex-col items-center justify-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-16 h-16 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),t("h3",{class:"mt-4 text-lg font-medium text-gray-700"},"No tickets found "),t("p",{class:"mt-1 text-sm text-gray-500"},"Get started by creating a new support ticket")])],-1)]))):a("",!0)])])])])])])])])]}),_:1})],64))}};export{Dt as default};
